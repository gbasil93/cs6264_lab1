import angr

def task1():
    project = angr.Project('./task1/task1', auto_load_libs=False)
    sm = project.factory.simulation_manager(save_unconstrained=True)

    while len(sm.unconstrained) == 0:
        sm.step()
    unconstrained = sm.unconstrained[0]
    crashing_input = unconstrained.posix.dumps(0)

    with open('crash_input.bin', 'wb') as f:
        f.write(crashing_input)

    print("Found buffer overflow!")
    print(repr(crashing_input))

if __name__ == "__main__":
    task1()